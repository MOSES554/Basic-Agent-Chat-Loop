# Close stale issues and PRs
# https://github.com/actions/stale
name: "Close Stale Issues and PRs"

on:
  schedule:
    # Run daily at 00:00 UTC
    - cron: "0 0 * * *"
  workflow_dispatch: # Allow manual triggering

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - name: Check for stale issues and PRs
        uses: actions/stale@v9
        with:
          # Stale issues
          days-before-issue-stale: 60
          days-before-issue-close: 14
          stale-issue-label: "status: stale"
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had recent activity.
            It will be closed in 14 days if no further activity occurs.

            If this issue is still relevant, please:
            - Comment to keep it open
            - Remove the "status: stale" label
            - Provide additional information or updates

            Thank you for your contributions!
          close-issue-message: |
            This issue has been automatically closed due to inactivity.

            If you believe this issue is still relevant:
            - Feel free to reopen it with additional context
            - Create a new issue referencing this one

            Thank you for understanding!

          # Stale PRs
          days-before-pr-stale: 30
          days-before-pr-close: 14
          stale-pr-label: "status: stale"
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity.
            It will be closed in 14 days if no further activity occurs.

            If you plan to continue working on this PR:
            - Push new commits or rebase on the latest main
            - Comment to indicate you're still working on it
            - Remove the "status: stale" label

            Thank you for your contribution!
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.

            If you'd like to continue this work:
            - Feel free to reopen this PR if it's still relevant
            - Create a new PR if the changes need to be rebased

            Thank you for your contribution!

          # Exemptions
          exempt-issue-labels: "priority: high,status: in-progress,status: blocked"
          exempt-pr-labels: "priority: high,status: in-progress,status: blocked"

          # Operations per run (to avoid rate limiting)
          operations-per-run: 100

          # Don't close issues/PRs with recent updates
          exempt-milestones: true
          exempt-all-milestones: false
